<div class="grade">
  <div class="linha" data-horario="08:00">
    <div class="coluna" data-dia="0"></div>
    <div class="coluna" data-dia="1"></div>
    <div class="coluna" data-dia="2"></div>
    <div class="coluna" data-dia="3"></div>
    <div class="coluna" data-dia="4"></div>
    <div class="coluna" data-dia="5"></div>
    <div class="coluna" data-dia="7"></div>
  </div>
  <div class="linha" data-horario="09:00">
    <div class="coluna" data-dia="0"></div>
    <div class="coluna" data-dia="1"></div>
    <div class="coluna" data-dia="2"></div>
    <div class="coluna" data-dia="3"></div>
    <div class="coluna" data-dia="4"></div>
    <div class="coluna" data-dia="5"></div>
    <div class="coluna" data-dia="7"></div>
  </div>
  </div>
</div>
<style>
  .grade {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: repeat(auto-fit, 50px); /* Ajusta altura conforme necessário */
  }

  .linha {
    display: contents;
  }

  .coluna {
    border: 1px solid #ccc;
    min-height: 50px;
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/@shopify/draggable@1.0.0-beta.11/lib/draggable.bundle.js"></script>
<script>
  import { Draggable } from '@shopify/draggable';

  const draggable = new Draggable.Draggable(document.querySelectorAll('.container'), {
                        draggable: '.item',
                        dropzone: '.grade .coluna',
  });

  draggable.on('drag:stop', (event) => {
    const draggableElement = event.source;
    const dropzone = event.dropzone;

    if (dropzone) {
      // Obtenha os atributos do horário e dia do quadrado
      const dia = dropzone.dataset.dia;
      const horario = dropzone.closest('.linha').dataset.horario;

      // Validação e envio de dados
      salvarAula({
        grade_curricular_id: draggableElement.dataset.gradeCurricularId,
        dia: dia,
        horario_inicio: horario,
      });
    }
});

function salvarAula(aula) {
  fetch('/aulas', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(aula),
  }).then((response) => {
    if (response.ok) {
      alert('Aula salva com sucesso!');
    } else {
      alert('Erro ao salvar a aula.');
    }
  });
}

function adicionarNotificacao(mensagem) {
  const notificacoes = document.querySelector('#notificacoes');
  const novaNotificacao = document.createElement('div');
  novaNotificacao.className = 'notificacao';
  novaNotificacao.textContent = mensagem;
  notificacoes.appendChild(novaNotificacao);

  setTimeout(() => {
    novaNotificacao.remove();
  }, 5000); // Remove após 5 segundos
}

</script>